<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Symptom Analyzer - Your Health Companion</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="../static/css/analysis.css">
</head>
<body>
    <header class="header">
        <nav class="nav">
            <a href="home2.html" class="logo">ðŸ©º Your Health Companion</a>
            <a href="home2.html" class="back-btn">
                <i class="fas fa-arrow-left"></i> Back to Home
            </a>
        </nav>
    </header>

    <div class="container">
        <div class="hero-section">
            <h1>AI Symptom Analyzer</h1>
            <p>Describe your symptoms and get instant AI-powered health insights with possible conditions, treatments, and precautions.</p>
        </div>

        <div class="analysis-container">
            <!-- Input Section -->
            <div class="input-section">
                <h2 class="section-title">
                    <i class="fas fa-stethoscope"></i>
                    Tell us your symptoms
                </h2>

                <div class="symptom-input">
                    <label>Common Symptoms (click to select):</label>
                    <div class="symptom-tags" id="commonSymptoms">
                        <div class="symptom-tag" data-symptom="headache">Headache</div>
                        <div class="symptom-tag" data-symptom="fever">Fever</div>
                        <div class="symptom-tag" data-symptom="cough">Cough</div>
                        <div class="symptom-tag" data-symptom="fatigue">Fatigue</div>
                        <div class="symptom-tag" data-symptom="nausea">Nausea</div>
                        <div class="symptom-tag" data-symptom="sore throat">Sore Throat</div>
                        <div class="symptom-tag" data-symptom="body ache">Body Ache</div>
                        <div class="symptom-tag" data-symptom="runny nose">Runny Nose</div>
                        <div class="symptom-tag" data-symptom="dizziness">Dizziness</div>
                        <div class="symptom-tag" data-symptom="chest pain">Chest Pain</div>
                        <div class="symptom-tag" data-symptom="stomach pain">Stomach Pain</div>
                        <div class="symptom-tag" data-symptom="vomiting">Vomiting</div>
                    </div>
                </div>

                <div class="symptom-input">
                    <label>Add custom symptom:</label>
                    <div class="custom-symptom">
                        <input type="text" id="customSymptom" placeholder="Enter your symptom...">
                        <button class="add-btn" onclick="addCustomSymptom()">
                            <i class="fas fa-plus"></i> Add
                        </button>
                    </div>
                </div>

                <div class="selected-symptoms">
                    <label>Selected Symptoms:</label>
                    <div class="selected-list" id="selectedSymptoms">
                        <p style="color: rgba(30, 27, 75, 0.5); margin: 0;">No symptoms selected yet...</p>
                    </div>
                </div>

                <button class="analyze-btn" id="analyzeBtn" onclick="analyzeSymptoms()" disabled>
                    <i class="fas fa-search"></i> Analyze My Symptoms
                </button>
            </div>

            <!-- Results Section -->
            <div class="results-section" id="resultsSection">
                <h2 class="section-title">
                    <i class="fas fa-chart-line"></i>
                    Analysis Results
                </h2>
                <div style="text-align: center; padding: 2rem; color: rgba(30, 27, 75, 0.5);">
                    <i class="fas fa-clipboard-list" style="font-size: 3rem; margin-bottom: 1rem;"></i>
                    <p>Select your symptoms and click "Analyze My Symptoms" to get your health insights.</p>
                </div>
            </div>
        </div>

        <div class="disclaimer">
            <i class="fas fa-exclamation-triangle"></i>
            <p><strong>Medical Disclaimer:</strong> This tool is for informational purposes only and is not a substitute for professional medical advice, diagnosis, or treatment. Always consult with a qualified healthcare provider for any medical concerns.</p>
        </div>
    </div>

    <script>
        let selectedSymptoms = new Set();

        // Sample medical database (in real application, this would be from a server)
        const medicalDatabase = {
            "headache,fever,fatigue": {
                disease: "Common Cold/Flu",
                confidence: "85%",
                description: "Upper respiratory tract infection commonly caused by viruses",
                medicines: ["Paracetamol 500mg", "Rest and hydration", "Vitamin C supplements"],
                precautions: ["Stay hydrated", "Get plenty of rest", "Avoid close contact with others", "Wash hands frequently"]
            },
            "cough,sore throat,runny nose": {
                disease: "Upper Respiratory Infection",
                confidence: "80%",
                description: "Viral infection affecting the upper respiratory system",
                medicines: ["Cough syrup", "Throat lozenges", "Warm salt water gargle"],
                precautions: ["Drink warm fluids", "Use humidifier", "Avoid smoking", "Rest your voice"]
            },
            "stomach pain,nausea,vomiting": {
                disease: "Gastroenteritis",
                confidence: "75%",
                description: "Inflammation of the stomach and intestines, often due to infection",
                medicines: ["ORS (Oral Rehydration Solution)", "Probiotics", "Anti-nausea medication"],
                precautions: ["Stay hydrated", "Eat bland foods (BRAT diet)", "Avoid dairy and fatty foods", "Rest"]
            },
            "chest pain,dizziness": {
                disease: "Possible Cardiac Issue",
                confidence: "70%",
                description: "Symptoms may indicate heart-related problems - seek immediate medical attention",
                medicines: ["SEEK IMMEDIATE MEDICAL ATTENTION", "Do not self-medicate"],
                precautions: ["Call emergency services immediately", "Do not drive yourself", "Sit down and rest", "Inform someone nearby"]
            }
        };

        // Handle symptom tag clicks
        document.addEventListener('DOMContentLoaded', function() {
            const symptomTags = document.querySelectorAll('.symptom-tag');
            symptomTags.forEach(tag => {
                tag.addEventListener('click', function() {
                    const symptom = this.dataset.symptom;
                    toggleSymptom(symptom, this);
                });
            });
        });

        function toggleSymptom(symptom, element) {
            if (selectedSymptoms.has(symptom)) {
                selectedSymptoms.delete(symptom);
                element.classList.remove('selected');
            } else {
                selectedSymptoms.add(symptom);
                element.classList.add('selected');
            }
            updateSelectedList();
            updateAnalyzeButton();
        }

        function addCustomSymptom() {
            const input = document.getElementById('customSymptom');
            const symptom = input.value.trim().toLowerCase();
            
            if (symptom && !selectedSymptoms.has(symptom)) {
                selectedSymptoms.add(symptom);
                input.value = '';
                updateSelectedList();
                updateAnalyzeButton();
            }
        }

        function removeSymptom(symptom) {
            selectedSymptoms.delete(symptom);
            // Also remove selection from common symptoms
            const commonTags = document.querySelectorAll('.symptom-tag');
            commonTags.forEach(tag => {
                if (tag.dataset.symptom === symptom) {
                    tag.classList.remove('selected');
                }
            });
            updateSelectedList();
            updateAnalyzeButton();
        }

        function updateSelectedList() {
            const container = document.getElementById('selectedSymptoms');
            
            if (selectedSymptoms.size === 0) {
                container.innerHTML = '<p style="color: rgba(30, 27, 75, 0.5); margin: 0;">No symptoms selected yet...</p>';
                return;
            }

            let html = '';
            selectedSymptoms.forEach(symptom => {
                html += `<span class="selected-item">
                    ${symptom}
                    <span class="remove-symptom" onclick="removeSymptom('${symptom}')">Ã—</span>
                </span>`;
            });
            container.innerHTML = html;
        }

        function updateAnalyzeButton() {
            const button = document.getElementById('analyzeBtn');
            button.disabled = selectedSymptoms.size === 0;
        }

        function analyzeSymptoms() {
            if (selectedSymptoms.size === 0) return;

            const resultsSection = document.getElementById('resultsSection');
            
            // Show loading
            resultsSection.innerHTML = `
                <h2 class="section-title">
                    <i class="fas fa-chart-line"></i>
                    Analysis Results
                </h2>
                <div class="loading">
                    <i class="fas fa-spinner"></i>
                    <p>Analyzing your symptoms...</p>
                </div>
            `;

            // Simulate API call delay
            setTimeout(() => {
                const result = findBestMatch(Array.from(selectedSymptoms));
                displayResults(result);
            }, 2000);
        }

        function findBestMatch(symptoms) {
            // Simple matching algorithm - in real app, this would use ML
            let bestMatch = null;
            let bestScore = 0;

            for (const [key, data] of Object.entries(medicalDatabase)) {
                const dbSymptoms = key.split(',');
                let score = 0;
                
                symptoms.forEach(symptom => {
                    dbSymptoms.forEach(dbSymptom => {
                        if (symptom.includes(dbSymptom) || dbSymptom.includes(symptom)) {
                            score++;
                        }
                    });
                });

                if (score > bestScore) {
                    bestScore = score;
                    bestMatch = data;
                }
            }

            // If no good match, return generic advice
            if (!bestMatch || bestScore === 0) {
                return {
                    disease: "General Health Concern",
                    confidence: "60%",
                    description: "Based on your symptoms, we recommend consulting with a healthcare professional",
                    medicines: ["Consult a doctor", "Stay hydrated", "Get adequate rest"],
                    precautions: ["Monitor symptoms", "Seek medical advice if symptoms worsen", "Maintain good hygiene", "Rest adequately"]
                };
            }

            return bestMatch;
        }

        function displayResults(result) {
            const resultsSection = document.getElementById('resultsSection');
            
            resultsSection.innerHTML = `
                <h2 class="section-title">
                    <i class="fas fa-chart-line"></i>
                    Analysis Results
                </h2>
                
                <div class="result-card disease-card">
                    <h3>
                        <i class="fas fa-diagnoses"></i>
                        Possible Condition
                        <span class="confidence">${result.confidence}</span>
                    </h3>
                    <p><strong>${result.disease}</strong></p>
                    <p>${result.description}</p>
                </div>

                <div class="result-card medicine-card">
                    <h3>
                        <i class="fas fa-pills"></i>
                        Recommended Treatment
                    </h3>
                    <ul>
                        ${result.medicines.map(med => `<li>${med}</li>`).join('')}
                    </ul>
                </div>

                <div class="result-card precaution-card">
                    <h3>
                        <i class="fas fa-shield-alt"></i>
                        Precautions & Care
                    </h3>
                    <ul>
                        ${result.precautions.map(prec => `<li>${prec}</li>`).join('')}
                    </ul>
                </div>
            `;
        }

        // Allow Enter key to add custom symptoms
        document.getElementById('customSymptom').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                addCustomSymptom();
            }
        });
    </script>
</body>
</html>